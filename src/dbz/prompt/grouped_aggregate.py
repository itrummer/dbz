def AGG_by_group(table, agg_col_idx, group_by_cols):
    """ Calculate aggregate value for each group.
    
    <OperatorInstructions>
    
    Args:
        table: calculate aggregate on this table
        agg_col_idx: index of column to aggregate
        group_by_cols: group by those columns
    
    Returns:
        new column containing aggregate for each group
    """