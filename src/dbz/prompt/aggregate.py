def AGG_by_group(table, agg_cols, group_by_cols):
    """ Calculate aggregate value for each group.
    
    <OperatorInstructions>
    
    Args:
        table: calculate aggregate on this table
        agg_cols: column indexes for aggregation
        group_by_cols: group by those columns
    
    Returns:
        new column containing aggregate for each group
    """